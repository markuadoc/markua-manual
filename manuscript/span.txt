{#span-elements}
# Span Elements

Span elements are elements which are contained inside block elements. For the purpose of this discussion, all the span elements shown will be shown inside a simple paragraph. There's nothing special about this, and other block elements could have been used.

## Emphasis

Markua is a plain text format designed for the writing of books and documents.

Books and documents have contained bold and italicized text--and have done so for centuries. Because of this, you'd think that the notion of making text bold or italic would be well understood.

If you think this, you are clearly not familiar with the work of the W3C.

### If You Want To Pretend This is Simple

Use `_one underscore_` or `*one asterisk*` around a span of text to (essentially) make it italic. Use `__two underscores__` or `**two asterisks**` around a span of text to (essentially) make it bold.

Here's what this looks like without the backticks:

Use _one underscore_ or *one asterisk* around a span of text to (essentially) make it italic. Use __two underscores__ or **two asterisks** around a span of text to (essentially) make it bold.

### The W3C and Semantic Emphasis

The above two sentences were (essentially) untrue.

There are four main ways of adding emphasis to text in HTML5:

1. [`<strong>`](http://www.w3.org/TR/html5/text-level-semantics.html#the-strong-element)
2. [`<b>`](http://www.w3.org/TR/html5/text-level-semantics.html#the-b-element)
3. [`<em>`](http://www.w3.org/TR/html5/text-level-semantics.html#the-em-element)
4. [`<i>`](http://www.w3.org/TR/html5/text-level-semantics.html#the-i-element)

The `<strong>` and `<b>` tags can wrap a span of text and add bold-esque emphasis to it, while the `<em>` and `<i>` tags can wrap a span of text and add italic-esque emphasis to it. I say "esque" since there is no guarantee that any of the four tags will actually make anything bold or italic. All four tags have actually become semantic tags in HTML5. Seriously.

So, what to do in Markua? Clearly we need to be able to make text bold and italic, since authors have been doing this in books for centuries.

But EPUB is one of the output targets of Markua, and since EPUB is essentially just zipped up HTML, we need to use some HTML tags for empahasis.

Now, what Markdown does is to just always generate `<strong>` and `<em>` tags. Both `**two asterisks**` and `__two underscores__` make a `<strong>` tag, and `*one asterisk*` and `_one underscore_` make an `<em>` tag. This means that in 2004, John Gruber was clearly in the camp of "the `<b>` and `<i>` tags are unsemantic and bad".

(At that time, many people were in this camp, as HTML had gone to a dark place full of presentational attributes in tags. The "move all presentation to CSS" backlash was very necessary, but there were a couple places--such as this, and such as the deprecating of the `start` element of an `<ol>`--where semantic information was lumped in with presentation-only information and was unfairly maligned.)

Now, since you can inline HTML in Markdown, if you wanted filthy `<b>` and `<i>` tags, you could just add them yourself. In Markua, however, we don't support inlining HTML, so that's not an option.

So, what to do?

Let's think about the goal of Markua:

> Markua is intended to be extremely simple and powerful. We want Markua to be the best way in the world to write everything from a short story or a novel to a computer programming book, user manual or doctoral thesis.

So, given this, we want to provide the power of picking what kind of emphasis that you want, while ensuring that Markua is simple to learn.

We need to support all four ways of producing emphasis in Markdown (one and two asterisks and underscores), and we want to be able to produce all four of the (newly semantic!) emphasis tags in HTML5.

That's exactly what we're going to do. Unlike Markdown which defines four input tags and only two outputs, we're going to map the four inputs to four outputs.

There are actually a number of benefits to this:

* Publishers can style `<b>` and `<strong>` differently. The `<strong>` tag can produce text which is using an even heavier-weight font than the `<b>` tag.
* Authors can italicize things they are supposed to (e.g. the titles of books), without implying the kind of semantic emphasis of the `<em>` tag.
* Since the four combinations of asterisks and underscores produces different output, which to choose will be determined by the desired output, not personal taste of "do you prefer underscores or asterisks". This means that multi-author Markua projects won't have to have pointless writing style debates about which type of Markua markup to use.
* All Markdown text which has any of the four kinds of emphasis will still generate emphasis that looks like this in Markua.
* Text editors (e.g. iA Writer) which know how to show emphasis for Markdown syntax will do so with Markua emphasis syntax.

### Italics with `_Single Undersores_` (`<i>`)

You can surround a span with `_single underscores_` to make it italic. This will produce the `<i>` tag in HTML. Markua Processors must make this look italic if generating a PDF from the Markua document.

#### Markua Syntax

```
This is some _italicized with an old-school but now semantic i tag_ text.
```

#### HTML Output

```
<p>This is some <i>italicized with an old-school but now semantic i tag</i> text.</p>
```

#### Example Output

This is some _italicized with an old-school but now semantic i tag_ text.

### Emphasis with `*Single Asterisks*` (`<em>`)

You can surround a span with `*single underscores*` to make it have emphasis. This will produce the `<em>` tag in HTML. Markua Processors should make this look italic if generating a PDF from the Markua document.

#### Markua Syntax

```
This is some *emphasized with a new school, semantic but still usually italic, em tag* text.
```

#### HTML Output

```
<p>This is some <em>emphasized with a new school, semantic but still usually italic, em tag</em> text.</p>
```

#### Example Output

This is some *emphasized with a new school, semantic but still usually italic, em tag* text.

### Bold with `__Double Undersores__` (`<b>`)

You can surround a span with `__double underscores__` to make it bold. This will produce the `<b>` tag in HTML. Markua Processors must make this look bold if generating a PDF from the Markua document.

#### Markua Syntax

```
This is some __bolded with an old-school, but also now semantic, b tag__ text.
```

#### HTML Output

```
<p>This is some <b>bolded with an old-school, but also now semantic, b tag</b> text.</p>
```

#### Example Output

This is some __bolded with an old-school, but also now semantic, b tag__ text.

### Strong with `**Double Asterisks**` (`<strong>`)

You can surround a span with `**double asterisks**` to make it strongly bold. This will produce the `<strong>` tag in HTML. Markua Processors should make this look bold if generating a PDF from the Markua document.

One option for Markua processors is to make it look even heavier-weight than `__double underscore__` bold text. For example, __double underscore__ text could be a bold font, and **double asterisk** text could be a "heavy" or "black" font. (For example, fonts such as Avenir have a "heavy" weight a "black" weight version, as well as lighter versions.)

#### Markua Syntax

```
This is some **strongly emphasized with a new school, semantic but still usually bold, strong tag** text.
```

#### HTML Output

```
<p>This is some <strong>strongly emphasized with a new school, semantic but still usually bold, strong tag</strong> text.</p>
```

#### Example Output

This is some **strongly emphasized with a new school, semantic but still usually bold, strong tag** text.

### Bold and Italic with `___Three Underscores___` (`<b><i>`)

One consequence of specifying bold and italic this way is that Markua gets the bold + italic combination essentially for free: three underscores wrapping text makes it both bold and italic. This is both elegant and logically consistent: one underscore makes a span of text italic, and two underscores make it bold, so naturally three would make it both bold and italic.

#### Markua Syntax

```
This is some ___bold and italic___ text.
```

#### HTML Output

Note that in Markua-generated HTML the `<b>` tag is on the outside wrapping the `<i>` tag on the inside.

```
<p>This is some <b><i>bold and italic</i></b> text.</p>
```

#### Example Output

This is some ___bold and italic___ text.

### Strong and Emphasis with `***Three Asterisks***` (`<strong><em>`)

One consequence of specifying strong and emphasis this way is that Markua gets the strong + emphasis combination essentially for free: three asterisks wrapping text makes it both strong and with emphasis. This is both elegant and logically consistent: one asterisk makes a span of text have emphasis, and two underscores make it strong, so naturally three would make it both strong and with emphasis.

#### Markua Syntax

```
This is some ***strong and with emphasis*** text.
```

#### HTML Output

Note that in Markua-generated HTML the `<strong>` tag is on the outside wrapping the `<em>` tag on the inside.

```
<p>This is some <strong><em>strong and with emphasis</em></strong> text.</p>
```

#### Example Output

This is some ***strong and with emphasis*** text.

### Underlines with `____Four____` Underscores

Believe it or not, underline is not just a typewriter version of italics. In some languages, underlining serves a distinct, legitimate purpose.

So, how to support this in Markua?

The combination of one, two and three underscores have all been taken. So have the combination of one, two and three asterisks. So, we're left with `____four underscores____` for underlining. This is a bit gross, but thankfully, underlining is a lot less used than bold and italics in most languages.

#### Markua Syntax

```
This is ____some underlined____ text.
```

#### HTML Output

Markua processors can either generate `<span class="underline">` or `<u>` in this case, depending on whether they wish to target EPUB 2 or HTML5.

EPUB 2:

```
<p>This is some <span class="underline">bold and italic</span> text.</p>
```

HTML5:

```
<p>This is some <u>bold and italic</u> text.</p>
```

#### Example Output

This is ____some underlined____ text.

### Other Amusing Combinations Are Also Legal If Nested Properly

You can also combine underscores and asterisks for amusement, as long as there is proper nesting.

The following all work as expected:

* `**_Strong and Italic_**` produces `<strong><i>Strong and Italic</i></strong>`
* `_**Italic and Strong**_` produces `<i><strong>Italic and Strong</strong></i>`
* `__*Bold and Emphasis*__` produces `<b><em>Bold and Emphasis</em></b>`
* `*__Emphasis and Bold__*` produces `<em><b>Emphasis and Bold</b></em>`

You can also use all the tags intermingled with other text, again, as long as there is proper nesting.

#### Markua Syntax:

```
I know *this is __silly__ of course but **it will _work_** however it will drive you _mad_* and you don't want that.
```

#### HTML Output

```
I know <em>this is <b>silly</b> of course but <strong>it will <i>work</i></strong> however it will drive you <i>mad</i></em> and you don't want that.
```

#### Example Output

I know *this is __silly__ of course but **it will _work_** however it will drive you _mad_* and you don't want that.

### Invalid Nesting Is Illegal

If emphasis is nested in an invalid combination, Markua processors must simply output the formatting instead of exploding.

The following are all invalid Markua:

* `This is **_not nested**_ properly.`
* `This is also *__not nested*__ properly.`
* `This __*must__* fail too.`

### Strikethrough

Strikethrough is made with `~~two tildes~~` surrounding the text. (This is the same syntax as is used by John Macfarlane's excellent [pandoc](http://johnmacfarlane.net/pandoc/README.html).)

#### Markua Syntax

```
Strikethrough is made with ~~two tildes~~ surrounding the text.
```

#### HTML Output

```
<p>Strikethrough is made with <span class="strikethrough">two tildes</span> surrounding the text.</p>
```

Markua never specifies CSS, to allow for maximum flexibility and competition on behalf of Markua Processor implementations.

However, in this case, the following CSS rule is strongly recommended:

```
.strikethrough {
  text-decoration: line-through;
}
```

#### Example Output

Strikethrough is made with ~~two tildes~~ surrounding the text.

### Superscript

To make a span be in superscript, you surround it with carets. (This is the same syntax as is used by pandoc.)

#### Markua Syntax

```
5^3^ is 125.
```

#### HTML Output

```
<p>5<sup>3</sup> is 125.</p>
```

#### Example Output

5^3^ is 125.

### Subscript

To make a span be in subscript, you surround it with one tilde each. (This is the same syntax as is used by pandoc.)

#### Markua Syntax

```
What he thought was H~2~O was H~2~SO~4~.
```

#### HTML Output

```
<p>What he thought was H<sub>2</sub>O was H<sub>2</sub>SO<sub>4</sub>.
```

#### Example Output

What he thought was H~2~O was H~2~SO~4~.

## Links

{class: warning}
B> There is no support for Markdown's reference style images in Markua.

### Automatic Links

You can make automatic links to URLs by putting the URL in angle brackets like `<http://markua.com>` this: <http://markua.com>

Automatic links do not create footnotes.

### Links

You can create normal hyperlinks.

The way that links should be displayed is determined by the value of the `urls` [setting](#setting-keys-and-values).

#### Markua Syntax

```
This is [link text](http://markua.com) a link.
```

#### HTML Output

```
<p>This is <a href="http://markua.com">link text</a> a link.</p>
```

#### Example Output

This is [link text](http://markua.com) a link.

## Footnotes

{class: warning}
B> TODO

{#crosslinks}
## Crosslinks and `id`s

There are two parts to making a crosslink.

1. Define an id.
2. Link to that id with a crosslink.

### Defining an `id` on Block and Span Elements, Using `{#some-id}` Syntax Only

To define an `id`, you create an `id` attribute on a block or span element.

If you use `id`s, chances are you use a *lot* of them. So, if Markua supported a syntax of `{id: some-id}`, you'd be typing that a *lot*. Instead, Markua defines a shorthand syntax of `{#some-id}` to define an `id` attribute.

W> This syntax of `{#some-id}` is the **only** way to define an `id`.



To define an id, just create an `id` attribute above a block element or attached to a span element.

### Defining an `id` on a Block Element

There are two ways to define an `id` on a block element.

First, using an `id` attribute:

```
{id: some-id}
This is a paragraph with the id of `some-id`.
```

Second, using a shorthand approach:

```
{#some-id}
This is a paragraph with the id of `some-id`.
```

### Defining an `id` on a Span Element

You can define an `id` on a span element. To do this, simply add an `id` attribute definition (either the explicit `{id: foo}` or the shorthand `{#foo}` version) in curly braces following any span element.

#### Examples

TODO - single or double quotes on id attrs in HTML?

##### Example 1: Defining an `id` on a single word

###### Markua Syntax

{#input_span_id_1}
```
The words foo{#foo} and bar{id: bar} both have ids.
```

###### HTML Output

{#output_span_id_1}
```
<p>The words <span id="foo">foo</span> and <span id="bar">bar</span> both have ids.</p>
```

###### Example Output

The words foo{#foo} and bar{id: bar} both have ids.

##### Example 2: Defining an `id` on a code span

Code spans, like any span, can have `id`s.

###### Markua Syntax

{#input_span_id_2}
```
Java code is verbose, e.g. `public static void main(String[] args)`{#java}.
```

###### HTML Output

{#output_span_id_2}
```
<p>Java code is verbose, e.g. <code id="java">public static void main(String[] args)`</code>.</p>
```

###### Example Output

Java code is verbose, e.g. `public static void main(String[] args)`{#java}.

##### Example 3: Defining an `id` on a span of emphasized text

Any span can have `id`s -- even spans which are produced by formatting characters. (Note that in this contrived example, these would be better served by index entries than ids.)

###### Markua Syntax

{#input_span_id_3}
```
The ideas behind *Leanpub*{id: leanpub} are explained in Peter's book _Lean Publishing_{#lean}.
```

###### HTML Output

{#output_span_id_3}
```
<p>The ideas behind <em id="leanpub">Leanpub</em> are explained in Peter's book <i id="lean">Lean Publishing</i>.</p>
```

###### Example Output

The ideas behind *Leanpub*{id: leanpub} are explained in Peter's book _Lean Publishing_{#lean}.

##### Example 4: Nesting `id` definitions inside spans

An `id` attribute can be defined on a span or word regardless of whether it is contained in a span.

###### Markua Syntax

{#input_span_id_4}
```
This is *a **very very{#very} contrived** example{id: example}*{#contrived} showing this.
```

###### HTML Output

{#output_span_id_4}
```
<p>This is <em id="contrived">a <strong>very <span id="very">very</span> contrived</strong> <span id="example">example</span></em> showing this.</p>
```

###### Example Output

This is *a **very very{#very} contrived** example{id: example}*{#contrived} showing this.

### Referencing an `id` With a Crosslink

Now, regardless of how you defined the id, you then link to it to create a crosslink. To do this, you use the `#` character and the id in a link:

```
[link text](#some-id)
```

This syntax is intended to be reminiscent of HTML anchor tags, not of `h1` titles in Markua.

Special rules:

* If a Markua document contains duplicate `id` attribute values, the first one is used and the subsequent ones are ignored. A Markua Processor should output a warning about duplicate `id`s.
* Crosslinks that reference an unused `id` may either be created as a (broken, non-functional) link or be created as normal text (not a link) by a Markua Processor. The Markua Processor may also [output a warning](#implementor-rules) about this somewhere, but not in the actual document text itself.

### Referencing Chapter, Section and Figure Heading Names and Numbers in Crosslinks

Chapters, sections and figures with captions often have two useful properties for writers:

1. A name which is often short and useful to reference.
2. A number, if numbering is turned on.

Whether the numbers exist is determined by the `number-chapters`, `number-parts` and `number-figures` [attributes](#setting-keys-and-values).

Here's how these references to titles and numbers work:

* `#t` is for "title"
* `#n` is for "number"
* `#d` is for "description" (e.g. "Figure", "Chapter", "Section", "Example")
* `#f` is for "full title"

So, for "Figure 8.2: Anatomy of a Squirrel", these are:

* `#t` is "Anatomy of a Squirrel"
* `#n` is "8.2"
* `#d` is "Figure"
* `#f` is "Figure 8.2: Anatomy of a Squirrel"

Note that in this example, "Anatomy of a Squirrel" was typed by the author, whereas "Figure 8.2: " was generated by the Markua Processor. It does not matter; both can be referenced.

Also, note that regardless of section level, sections referenced in `#d` or `#f` are all called "Section" (not "Sub-Section", "Sub-Sub-Section", etc.)

The expectation is that `#f` will be used by authors who don't mind verbosity, and #t and #n will be used by authors who prefer control and brevity. The #d is for very lazy authors who like saving keystrokes and/or who don't know whether their publisher will call the code samples "Listing", "Example" or some other word and want to protect themselves against extra work.

The `code-sample-names`, 'figure-names` and `table-names` [settings](#setting-keys-and-values) control the words used to name things.

Examples:

`This is discussed in [section #n, #t](#crosslinks).`

`This is discussed in [#f](#crosslinks).`

`This is discussed in a [#d](#crosslinks) above.`

`See [chapter #n](#span-elements), which is the best chapter in this book.`

`This is in figure [#n](#fancy-diagram), arguably the fanciest diagram in this document.`

{class: warning}
B> TODO - specify HTML

A> Figures, chapters, code samples, etc all have implicit numbering.  So, #n always works even if numbering is off.  You'll just confuse readers.  If numbering is off, the `#f` will not include either the `#d` or `#n` parts: it will be "Anatomy of a Squirrel" not "Figure 8.2: Anatomy of a Squirrel".

## Code Spans

Code like `hello world` can be inserted using backticks inside a paragraph, heading, or any other block element.

### Example

#### Markua Syntax

```
Here is some `hello world` span code.
```

#### HTML Output

```
<p>Here is some <code>hello world</code> span code.</p>
```

#### Example Output

Here is some `hello world` span code.

### Two Backticks to Enclose One Backtick

Just as with Markdown, to show a literal backtick, you use *two* backticks to start and end your code span. (The Markdown spec says multiple backticks; Markua says exactly two.)

Note that like Markdon, any leading or trailing spaces in a code span are removed.

#### Markua Syntax

```
Here is some ``code with a backtick (`) in it`` and other text.

If you want to have a backtick by itself, just use you need to have spaces around it like this `` ` ``. The enclosed backtick cannot start or end the code block.
```

#### HTML Output

```
<p>Here is some <code>code with a backtick (`) in it</code> and other text.</p>
<p>If you want to have a backtick by itself, just use you need to have spaces around it like this <code>`</code>. The enclosed backtick cannot start or end the code block.</p>
```

#### Example Output

Here is some ``code with a backtick (`) in it`` and other text.

If you want to have a backtick by itself, just use you need to have spaces around it like this `` ` ``. The enclosed backtick cannot start or end the code block.

{#math-span}
## Math Spans: Verbose and \{$$}

Math can be inserted as span elements as well as as a [block element](#math-blocks).

To do this, there's a verbose syntax and a syntactic sugar syntax.

The verbose syntax:

```
blah blah {math: mathml}here's your math{/math: mathml} blah blah

blah blah {math: latex}math here too!{/math: latex} blah blah
```

Note that since these are span elements, LaTeX math will look a lot better than MathML.

Also, this is very verbose. So, this is also supported:

```
blah blah {$$}math here too!{/$$} blah blah
```

This uses the default math engine. Chances are if you're using this syntax, you're using LaTeX math.

Here's a longer example:

#### Markua Syntax

```
The four kinematics equations are {$$}d = v_i t + \frac{1}{2} a t^2{/$$}, {$$}v_f^2 = v_i^2 + 2 a d{/$$}, {$$}v_f = v_i + a t{/$$} and {$$}d = \frac{1}{2}(v_i + v_f) t{/$$}.
```

#### HTML Output

Markua processors can do whatever they want here as well.

#### Example Output

The four kinematics equations are {$$}d = v_i t + \frac{1}{2} a t^2{/$$}, {$$}v_f^2 = v_i^2 + 2 a d{/$$}, {$$}v_f = v_i + a t{/$$} and {$$}d = \frac{1}{2}(v_i + v_f) t{/$$}.

## Soft hyphen

In certain rare situations, it's desirable to be able to give hints to a Markua Processor about where hypenation can be done.

This attribute makes us sad. However, it's a nod to reality. Hopefully this attribute is never used by authors writing the first draft of anything.

Soft hyphens are not output in HTML.

To insert a soft hyphen, used a backslash followed by a hyphen:

#### Markua Syntax

```
You can use soft hyphens to suggest where to break long words like Rumpel\-stiltskin if you wish.
```

#### HTML Output

<p>You can use soft hyphens to suggest where to break long words like Rumpel&shy;stiltskin if you wish.</p>

#### Example Output

You can use soft hyphens to suggest where to break long words like Rumpel-stiltskin if you wish.